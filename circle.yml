general:
    branches:
        ignore:
            - gh-pages

    artifacts:
        - build

machine:
    php:
        version: 5.6.14

dependencies:
    pre:
        - nvm alias default node
        - npm config set progress false
        - npm install -g npm
        - sudo composer self-update

    override:
        - npm install
        - composer install --prefer-source --no-interaction

    cache_directories:
        - node_modules
        - $HOME/.composer/cache/files

test:
    pre:
        - sed -i 's/^;//' "$HOME/.phpenv/versions/$(phpenv global)/etc/conf.d/xdebug.ini"

    override:
        - npm run-script lint-ci
        - composer run-script test-ci

    post:
        - vendor/bin/coveralls --verbose
